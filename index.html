<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Ata de Punição</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #FFFFFF; --bg-secondary: #F4F7FA; --card-bg: #FFFFFF;
            --accent-blue: #004a91; --accent-blue-light: #005cb3; --text-primary: #2D3748;
            --text-secondary: #5A657D; --border-color: #E2E8F0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-secondary); color: var(--text-primary); }
        .page-container { max-width: 1200px; margin: 40px auto; padding: 20px; }
        h1 { font-size: 2.25rem; margin-bottom: 24px; color: var(--accent-blue); border-bottom: 2px solid var(--accent-blue); padding-bottom: 16px; }
        .card { 
            background-color: var(--card-bg); border-radius: 12px; padding: 24px; 
            margin-bottom: 24px; border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .card h2 { color: var(--accent-blue); font-size: 1.25rem; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); }
        label { display: block; margin-top: 15px; margin-bottom: 5px; font-weight: 500; color: var(--text-secondary); }
        input, textarea, select {
            width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color);
            box-sizing: border-box; background-color: var(--bg-secondary); color: var(--text-primary);
            font-family: 'Poppins', sans-serif; font-size: 16px; transition: border-color 0.2s, box-shadow 0.2s;
            resize: none; /* <-- CORREÇÃO: Impede redimensionamento */
        }
        input:focus, textarea:focus, select:focus {
            outline: none; border-color: var(--accent-blue); box-shadow: 0 0 0 3px rgba(0, 74, 145, 0.2);
        }
        .grid-container-4col { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; }
        .button-primary {
            display: inline-block; padding: 12px 24px; background-color: var(--accent-blue);
            color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;
            margin-top: 20px; transition: background-color 0.2s, transform 0.2s;
        }
        .button-primary:hover { background-color: var(--accent-blue-light); transform: translateY(-2px); }
        
        /* Tabela de Saída */
        #output-container h3 { font-size: 1.5rem; color: var(--accent-blue); margin-top: 30px; margin-bottom: 15px; }
        .punishment-table {
            width: 100%; border-collapse: collapse; font-size: 0.9em; background-color: var(--bg-primary);
            border-radius: 8px; overflow: hidden; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .punishment-table th, .punishment-table td { padding: 12px 15px; border-bottom: 1px solid var(--border-color); text-align: left; }
        .punishment-table th { background-color: var(--bg-secondary); color: var(--text-secondary); font-weight: 600; }
        .punishment-table tr:last-child td { border-bottom: none; }
        .punishment-table td:nth-child(1) { width: 10%; } /* Data */
        .punishment-table td:nth-child(2) { width: 5%; } /* Nº */
        .punishment-table td:nth-child(3) { width: 15%; } /* Aluno */
        .punishment-table td:nth-child(4) { width: 10%; } /* Plantão */
        .punishment-table td:nth-child(5) { width: 15%; } /* Pelotão */
        .punishment-table td:nth-child(6) { width: 10%; } /* SEI */
        .punishment-table td:nth-child(7) { width: 20%; } /* Resumo */
        .punishment-table td:nth-child(8) { width: 15%; } /* Assinatura */

        #status { text-align: center; font-weight: 500; font-size: 1.1rem; padding: 10px; }
        
        @media (max-width: 900px) { .grid-container-4col { grid-template-columns: 1fr 1fr; } }
    </style>
</head>
<body>

<div class="page-container">
    <h1>Gerador de Ata de Punição</h1>

    <div class="card">
        <h2>1. Informações da Ata</h2>
        <div class="grid-container-4col">
            <div>
                <label for="ata_data">Data da Atividade:</label>
                <input type="text" id="ata_data" value="25 de OUTUBRO de 2025">
            </div>
            <div>
                <label for="ata_turno">Turno da Atividade:</label>
                <input type="text" id="ata_turno" value="SÁBADO - TARDE">
            </div>
        </div>
    </div>
    
    <div class="card">
        <h2>2. Adicionar Punido</h2>
        <div class="grid-container-4col">
            <div>
                <label for="p_numero">Nº do Aluno:</label>
                <input type="number" id="p_numero" placeholder="Ex: 11">
            </div>
            <div>
                <label for="p_data_relatorio">Data do Relatório:</label>
                <input type="text" id="p_data_relatorio" placeholder="Ex: 28/08/2025">
            </div>
            <div>
                <label for="p_sei">Nº SEI:</label>
                <input type="text" id="p_sei" placeholder="Ex: 75107489">
            </div>
            <div>
                <label for="p_resumo">Resumo:</label>
                <input type="text" id="p_resumo" placeholder="Ex: FAIXA AMASSADA">
            </div>
        </div>
        <button class="button-primary" onclick="adicionarPunido()">Adicionar Aluno</button>
    </div>

    <div class="card">
        <h2>3. Ata Pronta (Copiar e Colar no SEI)</h2>
        <div id="output-container">
            </div>
    </div>
</div>

<script>
    // =========================================================================
    // BANCO DE DADOS MESTRE DE ALUNOS (Embutido no JS)
    // =========================================================================
    const MASTER_ALUNO_DB = {
        1: {"nome": "MÁRCIO SOUZA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        2: {"nome": "RENATO", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        3: {"nome": "FERNANDO", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        4: {"nome": "ROBERTO FREITAS", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        5: {"nome": "SILVANA", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        6: {"nome": "DANIELLE PRADO", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        7: {"nome": "ARCOVERDE", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        8: {"nome": "AUREA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        9: {"nome": "R. FERREIRA", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        10: {"nome": "VICTOR FERREIRA", "plantao": "HOTEL", "pelotao": "2º PEL/2ª CIA"},
        11: {"nome": "ORLANDO", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        12: {"nome": "ISABELLA", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        13: {"nome": "BRENDA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        14: {"nome": "AMANDA COELHO", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        15: {"nome": "JUNIOR", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        16: {"nome": "EMILY", "plantao": "FOXTROT", "pelotao": "1º PEL/1ª CIA"},
        17: {"nome": "MURILO", "plantao": "HOTEL", "pelotao": "5º PEL/2ª CIA"},
        18: {"nome": "ARYANA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        19: {"nome": "ALENCAR", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        20: {"nome": "LUAN PEREIRA", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        21: {"nome": "MANOEL", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        24: {"nome": "MATHEUS MESQUITA", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        25: {"nome": "DAVI OLIVEIRA", "plantao": "FOXTROT", "pelotao": "3º PEL/2ª CIA"},
        26: {"nome": "MARCOLINO", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        27: {"nome": "FATIMA AGUIAR", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        28: {"nome": "LEMOS", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        29: {"nome": "MACIEL", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        30: {"nome": "M ALBUQUERQUE", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        31: {"nome": "ALLATAS SOUSA", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        32: {"nome": "KAYO GABRIEL", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        33: {"nome": "KAROLINE ABREU", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        34: {"nome": "GIOVANNI", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        35: {"nome": "PAULINO", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        36: {"nome": "M. FEITOSA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        37: {"nome": "VALDECI", "plantao": "FOXTROT", "pelotao": "6º PEL/2ª CIA"},
        38: {"nome": "W. SILVA", "plantao": "FOXTROT", "pelotao": "3º PEL/2ª CIA"},
        39: {"nome": "ELLIO", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        40: {"nome": "MARINHO", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        41: {"nome": "MALAQUIAS", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        42: {"nome": "CARLA ARAUJO", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        43: {"nome": "CINTIA SOUZA", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        44: {"nome": "PRISCILA CORREIA", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        45: {"nome": "WALYSON", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        46: {"nome": "GRANGEIRO", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        47: {"nome": "MACEDO", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
        48: {"nome": "ELVIS", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        49: {"nome": "JEFFERSON SILVA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        50: {"nome": "QUEIROZ", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        52: {"nome": "RUBSLEY", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        53: {"nome": "G. SILVA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        54: {"nome": "FRANÇA", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        57: {"nome": "SANTANA", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        58: {"nome": "WESLEY", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        59: {"nome": "RAYANNE", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        60: {"nome": "S.GOMES", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        61: {"nome": "FIRMINO", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        62: {"nome": "LUCAS MAGALHÃES", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        63: {"nome": "PAULO", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        64: {"nome": "BONFIM", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        66: {"nome": "JONATAS SANTOS", "plantao": "HOTEL", "pelotao": "2º PEL/2ª CIA"},
        67: {"nome": "LAYANNE", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        68: {"nome": "KAROLINNE MOREIRA", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        69: {"nome": "FALCÃO", "plantao": "FOXTROT", "pelotao": "3º PEL/2ª CIA"},
        70: {"nome": "MEIRA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        71: {"nome": "SERAFIM", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        72: {"nome": "NONATO", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        73: {"nome": "PEREIRA", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        74: {"nome": "GABRIEL", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        75: {"nome": "PEDRO", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        76: {"nome": "FERREIRA", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        77: {"nome": "EDUARDA", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        78: {"nome": "GISELE FERREIRA", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        79: {"nome": "DIOGENES", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        80: {"nome": "JOSE", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        81: {"nome": "COSTA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        82: {"nome": "MARCOS NASCIMENTO", "plantao": "INDIA", "pelotao": "1º PEL/2ª CIA"},
        83: {"nome": "P. SOUZA", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        84: {"nome": "SIDNEI ARAÚJO", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        85: {"nome": "ANDERSON", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
        86: {"nome": "FERNANDO CRUZ", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        87: {"nome": "ARYCLAYTON", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        88: {"nome": "S. NETO", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        89: {"nome": "SILVA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        90: {"nome": "RAFAEL BEZERRA", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        91: {"nome": "GESSICA", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        92: {"nome": "ALINE", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        93: {"nome": "REVERTHON", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        94: {"nome": "FERNANDA SOARES", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        95: {"nome": "BRUNO", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        96: {"nome": "ERIVELTON", "plantao": "HOTEL", "pelotao": "2º PEL/2ª CIA"},
        97: {"nome": "ITALO", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        98: {"nome": "EMANNUEL", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        99: {"nome": "G. GOMES", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        100: {"nome": "RENAN", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        101: {"nome": "SELTON", "plantao": "FOXTROT", "pelotao": "1D PEL/2ª CIA"},
        102: {"nome": "ALLAN MARIANO", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        103: {"nome": "RAISSA SOARES", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        105: {"nome": "JOSÉ NETO", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        106: {"nome": "LUCAS RANIELLE", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        107: {"nome": "LUCIANO", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        108: {"nome": "HENRIQUE", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        109: {"nome": "ERIKA DUARTE", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
        110: {"nome": "CÉSAR MEDEIROS", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        111: {"nome": "FELIPE MORAIS", "plantao": "HOTEL", "pelotao": "2º PEL/2ª CIA"},
        112: {"nome": "MARQUES", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        113: {"nome": "AURÉLIO", "plantao": "GOLF", "pelotao": "4º PEL/2ª CIA"},
        114: {"nome": "BARBALHO", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        115: {"nome": "VINICIUS OLIVEIRA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        116: {"nome": "SANTIAGO", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        118: {"nome": "DURVAL", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        119: {"nome": "VINÍCIUS SOUZA", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        120: {"nome": "EGITO", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        121: {"nome": "JOÃO NASCIMENTO", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        122: {"nome": "BATISTA", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        123: {"nome": "GONZAGA", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        125: {"nome": "MEDEIROS", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        126: {"nome": "GILMARA", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        127: {"nome": "CAIO GUIMARAES", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        128: {"nome": "ALEXANDRO GOMES", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        129: {"nome": "LUIZ NUNES", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        130: {"nome": "PAULO ROBERTO", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        131: {"nome": "RENATA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        132: {"nome": "SERGIO", "plantao": "INDIA", "pelotao": "1º PEL/2ª CIA"},
        133: {"nome": "ISRAEL", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        134: {"nome": "SAMEA FERRAZ", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        135: {"nome": "JOÃO HENRIQUE", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        136: {"nome": "PATRICIA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        137: {"nome": "RAFAEL PEREIRA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        138: {"nome": "ICARO", "plantao": "HOTEL", "pelotao": "5º PEL/2ª CIA"},
        139: {"nome": "JULIANA GONDIM", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        140: {"nome": "VICTOR COSTA", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        141: {"nome": "JULIANE CORDEIRO", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        142: {"nome": "JABNER", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        143: {"nome": "SAMARA MELO", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        144: {"nome": "EDJANE", "plantao": "HOTEL", "pelotao": "1D PEL/2ª CIA"},
        145: {"nome": "HIGOR ALVES", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        146: {"nome": "PEREIRA MORAIS", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        147: {"nome": "JORGE FILHO", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        148: {"nome": "OLAVO", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        149: {"nome": "CAVALCANTI", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        150: {"nome": "ROBERTA", "plantao": "INDIA", "pelotao": "1º PEL/2ª CIA"},
        151: {"nome": "OLIVEIRA JUNIOR", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        152: {"nome": "MOURA", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        153: {"nome": "AFONSO", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        154: {"nome": "DAYANE", "plantao": "FOXTROT", "pelotao": "2º PEL/2ª CIA"},
        156: {"nome": "MONALIZA", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        157: {"nome": "VALADARES", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        158: {"nome": "HEYVERSON", "plantao": "FOXTROT", "pelotao": "1º PEL/2ª CIA"},
        161: {"nome": "JOSE ALISSON", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        162: {"nome": "JESUS", "plantao": "HOTEL", "pelotao": "1D PEL/2ª CIA"},
        163: {"nome": "NATALIA", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        164: {"nome": "CIBELE", "plantao": "FOXTROT", "pelotao": "6º PEL/2ª CIA"},
        165: {"nome": "GUSTAVO", "plantao": "GOLF", "pelotao": "2º PEL/2ª CIA"},
        166: {"nome": "FELIPE FELIX", "plantao": "FOXTROT", "pelotao": "5º PEL/2ª CIA"},
        168: {"nome": "LEONAM", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        169: {"nome": "MATHEUS BARROS", "plantao": "INDIA", "pelotao": "6º PEL/2ª CIA"},
        170: {"nome": "ANTONIO REIS", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        171: {"nome": "JHONEY", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        172: {"nome": "FRANCISCO", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        173: {"nome": "IURY", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        174: {"nome": "LIMA PAIVA", "plantao": "FOXTROT", "pelotao": "1Multi-select"},
        175: {"nome": "LUIZ LEAL", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        176: {"nome": "RHAYSA", "plantao": "INDIA", "pelotao": "1º PEL/2ª CIA"},
        177: {"nome": "DIONIZIO", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
        178: {"nome": "HIAGO", "plantao": "INDIA", "pelotao": "4º PEL/2ª CIA"},
        179: {"nome": "DEBORA GOUVEIA", "plantao": "HOTEL", "pelotao": "2º PEL/2ª CIA"},
        180: {"nome": "NOBREGA", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        181: {"nome": "THAYNARA", "plantao": "GOLF", "pelotao": "3º PEL/2ª CIA"},
        182: {"nome": "JOSINALDO", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        183: {"nome": "JULIO", "plantao": "HOTEL", "pelotao": "5º PEL/2ª CIA"},
        184: {"nome": "ABRAÃO", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        185: {"nome": "RONILSON", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        186: {"nome": "SOUTO", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        187: {"nome": "BELEM", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
        188: {"nome": "MAXEMBERG", "plantao": "INDIA", "pelotao": "3º PEL/2ª CIA"},
        189: {"nome": "KAMYLA", "plantao": "HOTEL", "pelotao": "1º PEL/2ª CIA"},
        190: {"nome": "JÚLIA", "plantao": "GOLF", "pelotao": "5º PEL/2ª CIA"},
        191: {"nome": "SELTON", "plantao": "FOXTROT", "pelotao": "4º PEL/2ª CIA"},
        192: {"nome": "JEFFERSON GOMES", "plantao": "GOLF", "pelotao": "1º PEL/2ª CIA"},
        193: {"nome": "JAILTON", "plantao": "HOTEL", "pelotao": "3º PEL/2ª CIA"},
        194: {"nome": "KLEVER", "plantao": "INDIA", "pelotao": "5º PEL/2ª CIA"},
        195: {"nome": "PETTERSON", "plantao": "INDIA", "pelotao": "2º PEL/2ª CIA"},
        196: {"nome": "CARDOSO", "plantao": "GOLF", "pelotao": "6º PEL/2ª CIA"},
        197: {"nome": "ISRAEL OLIVEIRA", "plantao": "HOTEL", "pelotao": "4º PEL/2ª CIA"},
    };

    // =========================================================================
    // LÓGICA DO GERADOR E DO AGENDADOR (v30 - Atualizada)
    // =========================================================================
    const outputContainer = document.getElementById('output-container');
    let listaDePunicoes = [];

    // --- Lógica do Gerador de Ata ---
    function adicionarPunido() {
        try {
            const num = parseInt(document.getElementById('p_numero').value);
            const dataRelatorio = document.getElementById('p_data_relatorio').value;
            const sei = document.getElementById('p_sei').value;
            const resumo = document.getElementById('p_resumo').value;

            if (!num || isNaN(num)) {
                alert('Número do aluno é inválido.');
                return;
            }

            const alunoInfo = MASTER_ALUNO_DB[num];
            if (!alunoInfo) {
                alert(`Aluno com Nº ${num} não encontrado no Banco de Dados. Verifique o número.`);
                return;
            }

            const punicao = {
                n: String(num).padStart(2, '0'),
                aluno: alunoInfo.nome,
                plantao: alunoInfo.plantao,
                pelotao: alunoInfo.pelotao,
                data_relatorio: dataRelatorio || "N/A",
                sei: sei || "N/A",
                resumo: resumo || "N/A"
            };

            listaDePunicoes.push(punicao);
            gerarAtaFinal(); // Atualiza a tabela em tempo real
            
            // Limpa os campos
            document.getElementById('p_numero').value = '';
            document.getElementById('p_data_relatorio').value = '';
            document.getElementById('p_sei').value = '';
            document.getElementById('p_resumo').value = '';
            document.getElementById('p_numero').focus();

        } catch (e) {
            alert('Erro ao adicionar aluno: ' + e.message);
        }
    }

    function gerarAtaFinal() {
        const ataData = document.getElementById('ata_data').value;
        const ataTurno = document.getElementById('ata_turno').value;
        const outputContainer = document.getElementById('output-container');

        if (listaDePunicoes.length === 0) {
            outputContainer.innerHTML = '<p style="color: var(--text-secondary);">A tabela da ata aparecerá aqui assim que você adicionar o primeiro aluno.</p>';
            return;
        }

        // Ordena pela antiguidade (número)
        listaDePunicoes.sort((a, b) => parseInt(a.n) - parseInt(b.n));

        let tableHTML = `
            <p style="text-align: center; margin-bottom: 20px; font-weight: 600;">EXTRACLASSE - ${ataTurno.toUpperCase()}</p>
            <table class="punishment-table">
                <thead>
                    <tr>
                        <th>RELATÓRIO</th>
                        <th>№</th>
                        <th>ALUNO</th>
                        <th>PLANTÃO</th>
                        <th>PELOTÃO/2° CIA</th>
                        <th>SEI</th>
                        <th>RESUMO</th>
                        <th>ASSINATURA DO ALUNO NO ATO DA CIÊNCIA</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        listaDePunicoes.forEach(p => {
            tableHTML += `
                <tr>
                    <td>${p.data_relatorio}</td>
                    <td>${p.n}</td>
                    <td>${p.aluno}</td>
                    <td>${p.plantao}</td>
                    <td>${p.pelotao}</td>
                    <td>${p.sei}</td>
                    <td>${p.resumo}</td>
                    <td></td> </tr>
            `;
        });

        tableHTML += `</tbody></table>`;
        outputContainer.innerHTML = tableHTML;
    }

    // --- Lógica do Agendador (Workflow Gemini) ---
    // Esta função prepara os dados para você copiar e colar para o Gemini
    function prepararParaGemini() {
        const dataSabado = document.getElementById('agenda_data_sabado').value;
        const listaPermutas = document.getElementById('agenda_permutas').value;
        const listaPunidos = document.getElementById('agenda_punidos').value;
        const output = document.getElementById('agenda_output');

        if (!dataSabado || !listaPunidos) {
            alert("Preencha a Data do Sábado e a Lista de Punições.");
            return;
        }

        let prompt = `
Olá, Gemini. Por favor, agende as seguintes punições para mim.

**Contexto:**
Preciso agendar a lista de punidos abaixo para o fim de semana que começa no sábado, ${dataSabado}.
As regras de exceção são:
1.  **Punição emenda com serviço:**
    * Serviço na Sexta-feira: Não pode punir no Sábado de Manhã.
    * Serviço no Sábado: Não pode punir no Sábado (manhã/tarde) nem no Domingo de Manhã.
    * Serviço no Domingo: Não pode punir no Domingo (manhã/tarde).
2.  **Ordem de Agendamento:** A fila de punição segue a ordem: Sábado (Manhã), Sábado (Tarde), Domingo (Manhã), Domingo (Tarde).
3.  **Limite:** Máximo de 4 punições por fim de semana. A 5ª punição em diante deve ser agendada para "Próximo Fim de Semana".
4.  **Exceções:** O serviço que proíbe a punição inclui Plantão, Adjunto ou Sobreaviso.

**Listas de Exceção (Copie e cole no seu sistema):**
(Aqui eu colaria o banco de dados completo de plantões, adjuntos e sobreaviso, mas é muito grande. Vou apenas referenciar o fim de semana relevante.)

**Fim de Semana Solicitado (Começando em ${dataSabado}):**
* **Lista de Permutas (Ignorar):**
${listaPermutas || "Nenhuma"}

**Lista de Punição (Agendar esta lista):**
${listaPunidos}

**Sua Tarefa:**
Gere as 5 listas de saída (Sábado Manhã, Sábado Tarde, Domingo Manhã, Domingo Tarde, Próximo Fim de Semana) com os nomes dos alunos agendados corretamente, aplicando as regras de exceção e a regra do limite de 4 por fim de semana.
        `;

        output.value = prompt.trim();
        alert("Prompt copiado para a área de transferência!");
        navigator.clipboard.writeText(output.value);
    }
</script>

</body>
</html>
